# 事件驱动架构演示

本目录包含了完整的事件驱动架构演示代码，展示如何使用新的事件系统来构建现代化的语音输入应用。

## 文件说明

### event_driven_demo.py
完整的事件驱动架构演示，包括：

1. **事件系统设置**
   - 创建多个事件处理器（演示处理器、指标收集器、健康监控器、性能分析器）
   - 订阅各种类型的事件
   - 配置事件总线

2. **音频处理模拟**
   - 模拟音频流启动/停止
   - 模拟语音识别过程（部分结果和完整结果）
   - 模拟TTS播放
   - 模拟性能指标收集

3. **错误处理演示**
   - 一般错误处理
   - 关键错误处理
   - 系统健康监控

4. **系统状态报告**
   - 事件处理统计
   - 性能指标分析
   - 系统健康状态

## 运行演示

```bash
cd examples
python event_driven_demo.py
```

## 演示特性

### 事件类型
- 音频流事件（启动、停止、数据接收）
- 语音识别事件（开始、完成、部分结果）
- TTS播放事件（开始、完成）
- 系统事件（组件状态变更、错误、性能指标）

### 事件处理器
- **DemoEventHandler**: 记录所有接收到的事件
- **AudioMetricsCollector**: 收集音频相关指标
- **SystemHealthMonitor**: 监控系统健康状态
- **PerformanceAnalyzer**: 分析系统性能

### 系统协调
- 组件注册和依赖管理
- 健康检查和状态监控
- 错误处理和紧急停止

## 预期输出

演示运行时，你将看到类似以下的输出：

```
🚀 开始事件驱动架构演示...
🚀 启动系统协调器...
⚙️ 设置事件系统...
🎙️ 创建事件驱动音频捕获器...
✅ 音频捕获器初始化成功
🎬 开始模拟音频处理 (持续 10.0s)...
📝 [DemoHandler] 收到事件: 音频流已启动 (ID: demo_stream, 采样率: 16000Hz)
📝 [DemoHandler] 收到事件: 语音识别已启动 (ID: demo_recognizer, 语言: zh-CN)
...
📊 打印系统状态...
  DemoHandler: 处理了 15 个事件
  AudioMetricsCollector: {'audio_chunks': 100, 'recognition_count': 5, ...}
✅ 事件驱动架构演示完成!
```

## 扩展演示

你可以基于这个演示代码来：

1. 添加新的事件类型
2. 创建自定义事件处理器
3. 实现更复杂的业务逻辑
4. 测试系统性能和可靠性

## 依赖

- `events` 模块（事件驱动架构核心）
- `async_audio` 模块（异步音频处理）
- `audio_capture_v` 模块（原始音频捕获，用于适配器）

## 注意事项

- 演示使用测试模式，不需要实际的音频硬件
- 所有的音频数据都是模拟的
- 演示展示了完整的事件驱动架构工作流程