[build-system]
requires = ["setuptools>=61.0", "wheel"]
build-backend = "setuptools.build_meta"

[project]
name = "voice-input"
version = "0.2.5"
description = "A powerful real-time voice recognition offline system with pause/resume functionality and automatic Excel export capabilities."

[project.gui-scripts]
voice-gui = "voice_gui:main"

[tool.setuptools.packages.find]
where = ["."]
exclude = [
    "model/*",
    "onnx_deps/*",
    "tests/*",
    "debug/*",
    "logs/*",
    "reports/*",
    "*.pyc",
    "__pycache__",
    ".pytest_cache",
    ".mypy_cache"
]

[tool.setuptools.package-data]
"*" = ["*.yaml", "*.json", "*.txt", "*.md"]

[tool.pyinstaller]
# PyInstalleré…ç½®
exe_name = "VoiceInput_v2.5"
icon = "icon.ico"  # å¦‚æœæœ‰å›¾æ ‡æ–‡ä»¶çš„è¯
console = false  # GUIåº”ç”¨ï¼Œä¸æ˜¾ç¤ºæ§åˆ¶å°çª—å£
onefile = false  # ä½¿ç”¨ç›®å½•æ¨¡å¼ï¼Œå‡å°‘å¯åŠ¨æ—¶é—´
strip = false  # ä¿ç•™è°ƒè¯•ä¿¡æ¯
uac_admin = false  # ä¸éœ€è¦ç®¡ç†å‘˜æƒé™
hidden_imports = [
    "PySide6.QtCore",
    "PySide6.QtWidgets",
    "PySide6.QtGui",
    "funasr",
    "onnxruntime",
    "torch",
    "numpy",
    "openpyxl",
    "pyyaml",
    "cn2an"
]

# æ’é™¤çš„æ¨¡å—ï¼ˆå¤§æ–‡ä»¶å’Œä¸éœ€è¦æ‰“åŒ…çš„ï¼‰
excludes = [
    "model/fun",
    "onnx_deps",
    "tests",
    "debug",
    "logs",
    "reports",
    ".git",
    ".pytest_cache",
    "__pycache__",
    "*.pyc"
]

# æ•°æ®æ–‡ä»¶
datas = [
    ("config.yaml", "."),
    ("voice_correction_dict.txt", "."),
    ("templates/*.xlsx", "reports/templates/"),
    ("requirements.txt", ".")
]

# è¿è¡Œæ—¶é’©å­
runtime_hooks = [
    "hooks/pyi_rthook.py"
]

# ä¼˜åŒ–é€‰é¡¹
opt_level = 1
noconfirm = true
authors = [{name = "Pierre.W", email = "xingw1013@gmail.com"}]
readme = "README.md"
requires-python = ">=3.11"
dependencies = [
    # æ ¸å¿ƒAI/MLä¾èµ–
    "funasr==1.2.7",
    "modelscope==1.31.0",
    "onnxruntime==1.15.1",
    "onnx==1.14.0",
    "numpy==1.26.4",
    "torch==2.3.1+cpu",
    "torchaudio==2.3.1+cpu",
    "torchvision==0.18.1+cpu",

    # ä¸­æ–‡å¤„ç†å’Œæ–‡æœ¬åˆ†æ
    "cn2an==0.5.23",
    "jieba==0.42.1",

    # éŸ³é¢‘å¤„ç†
    "pyaudio==0.2.14",
    "soundfile==0.13.1",
    "librosa==0.11.0",
    "sounddevice==0.5.2",

    # Excelå’Œæ•°æ®å¤„ç†
    "openpyxl==3.1.5",
    "pandas==2.3.2",

    # GUIç•Œé¢ (ä½¿ç”¨ç¨³å®šç‰ˆæœ¬ï¼Œé¿å…å¼ƒç”¨è­¦å‘Š)
    "PySide6==6.6.3.1",
    "PySide6_Addons==6.6.3.1",
    "PySide6_Essentials==6.6.3.1",

    # ç½‘ç»œå’ŒHTTP
    "requests==2.32.5",
    "urllib3==2.5.0",
    "certifi==2025.8.3",
    "charset-normalizer==3.4.3",

    # ç³»ç»Ÿå·¥å…·å’Œå®ç”¨ç¨‹åº
    "tqdm==4.67.1",
    "click==8.3.0",
    "psutil==7.1.0",
    "pynput==1.8.1",

    # é…ç½®ç®¡ç†
    "pyyaml==6.0.3",
    "omegaconf==2.3.0",

    # æ—¥æœŸæ—¶é—´å¤„ç†
    "python-dateutil==2.9.0.post0",
    "pytz==2025.2",
    "tzdata==2025.2",

    # ç¼–ç å’ŒåŠ å¯†
    "cryptography==46.0.3",
    "pycryptodome==3.23.0",

    # æ—¥å¿—å’Œè°ƒè¯•
    "colorama==0.4.6",
    "coloredlogs==15.0.1",

    # ç±»å‹æ£€æŸ¥å’Œå¼€å‘å·¥å…·
    "mypy==1.18.2",
    "mypy-extensions==1.1.0",
    "types-openpyxl==3.1.5.20250919",
    "types-pyaudio==0.2.16.20250801",
    "types-pynput==1.8.1.20250809",
    "types-pytz==2025.2.0.20250809",
    "typing_extensions==4.15.0",

    # è¯­éŸ³è¯†åˆ«ç›¸å…³
    "SpeechRecognition==3.14.3",
    "vosk==0.45",

    # TTS (Text-to-Speech)
    "piper-tts==1.3.0",

    # æ–‡ä»¶å’Œæ•°æ®å¤„ç†
    "aiofiles==24.1.0",
    "packaging==25.0",

    # æµ‹è¯•å·¥å…·
    "pytest==8.4.2",
    "pytest-cov==7.0.0",

    # Gitå·¥å…·
    "pre-commit==4.3.0",

    # Jupyterç›¸å…³ (å¯é€‰)
    "ipykernel==6.30.1",
    "jupyter_client==8.6.3",
    "jupyter_core==5.8.1",

    # æ•°æ®å¯è§†åŒ– (å¯é€‰)
    "matplotlib==3.10.7",

    # å…¶ä»–ä¾èµ–
    "six==1.17.0",
    "idna==3.10",
    "et_xmlfile==2.0.0",
    "pathspec==0.12.1",
    "tree==0.2.4",
    "websockets==15.0.1",
]

# ğŸ‘‡ This is the key: tell setuptools to treat root .py files as top-level modules
[tool.setuptools]
py-modules = ["main", "audio_capture_v", "excel_exporter", "TTSengine"]  # â† list your root .py files here

[tool.setuptools.packages.find]
where = ["."]
include = ["*"]
exclude = ["tests*"]

[tool.mypy]
python_version = "3.11"          # æŒ‰ä½ å®é™…ç‰ˆæœ¬å†™
explicit_package_bases = true    # æ˜¾å¼æŒ‡å®šåŒ…åŸºç¡€è·¯å¾„
ignore_missing_imports = true    # å…¨å±€å¿½ç•¥æ—  stub çš„åº“
exclude = [
    '^backup/',          # æ’é™¤ backup ç›®å½•åŠå­ç›®å½•
    '^__pycache__/',     # æ’é™¤ __pycache__
    '.*\.xlsx$',         # æ’é™¤æ‰€æœ‰ .xlsx æ–‡ä»¶
	'^test_develop/'     # æ’é™¤ test_develop ç›®å½•åŠå­ç›®å½•
]
# å¦‚æœä½ åªæƒ³å¿½ç•¥ cn2anã€voskï¼Œç”¨ä¸‹é¢ä¸¤è¡Œä»£æ›¿ä¸Šé¢é‚£å¥
# [[tool.mypy.overrides]]
# module = ["cn2an.*", "vosk.*"]
# ignore_missing_imports = true