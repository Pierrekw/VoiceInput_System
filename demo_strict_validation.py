#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ä¸¥æ ¼æ•°å­—æå–éªŒè¯ - æœ€ç»ˆæ¼”ç¤º
å±•ç¤ºæ–°å¢çš„ä¸¥æ ¼éªŒè¯è§„åˆ™åŠŸèƒ½
"""

import sys
import os

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°Pythonè·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.abspath(__file__)))

from text_processor import TextProcessor, VoiceCommandProcessor


def demo_strict_validation():
    """æ¼”ç¤ºä¸¥æ ¼éªŒè¯è§„åˆ™"""
    processor = TextProcessor()
    command_processor = VoiceCommandProcessor()

    print("ğŸ¯ ä¸¥æ ¼æ•°å­—æå–éªŒè¯ - æœ€ç»ˆæ¼”ç¤º")
    print("=" * 80)
    print()
    print("ğŸ“‹ ä¸¥æ ¼éªŒè¯è§„åˆ™è¯´æ˜:")
    print("   1. åªæå–çº¯æ•°å­—è¾“å…¥ï¼ˆå¦‚'200'ã€'1300'ï¼‰")
    print("   2. è·³è¿‡æ–‡æœ¬ä¸Šä¸‹æ–‡ä¸­çš„100å€æ•°ï¼ˆâ‰¥2ä¸ªå‘¨å›´å­—ç¬¦ï¼‰")
    print("   3. è¯­éŸ³å‘½ä»¤éªŒè¯ï¼ˆç¡®ä¿ä¸æ˜¯å‘½ä»¤ï¼‰")
    print("   4. ä¿ç•™æ‰€æœ‰é100å€æ•°ï¼ˆåŒ…æ‹¬50ã€25.5ç­‰ï¼‰")
    print()
    print("=" * 80)

    # æ ¸å¿ƒæ¼”ç¤ºç”¨ä¾‹
    demo_cases = [
        # ===== æ ¸å¿ƒåŠŸèƒ½æ¼”ç¤º =====
        ("ç”¨æˆ·è¯´ï¼š200", "200", "âœ… çº¯æ•°å­—ï¼Œæå–", [200.0]),
        ("ç”¨æˆ·è¯´ï¼š1300", "1300", "âœ… çº¯æ•°å­—ï¼Œæå–", [1300.0]),
        ("ç”¨æˆ·è¯´ï¼šåƒé¥­200", "åƒé¥­200", "âŒ æ–‡æœ¬ä¸Šä¸‹æ–‡ä¸­çš„100å€æ•°ï¼Œè·³è¿‡", []),
        ("ç”¨æˆ·è¯´ï¼šä»·æ ¼ä¸º300å…ƒ", "ä»·æ ¼ä¸º300å…ƒ", "âŒ æ–‡æœ¬ä¸Šä¸‹æ–‡ä¸­çš„100å€æ•°ï¼Œè·³è¿‡", []),
        ("ç”¨æˆ·è¯´ï¼š50", "50", "âœ… é100å€æ•°ï¼Œæå–", [50.0]),
        ("ç”¨æˆ·è¯´ï¼š25.5", "25.5", "âœ… å°æ•°ï¼Œæå–", [25.5]),

        # ===== æ™ºèƒ½è¿‡æ»¤æ¼”ç¤º =====
        ("ç”¨æˆ·è¯´ï¼šä»·æ ¼200é•¿åº¦50", "ä»·æ ¼200é•¿åº¦50", "âœ… æ··åˆæ–‡æœ¬ï¼Œåªæå–é100å€æ•°", [50.0]),
        ("ç”¨æˆ·è¯´ï¼šæ¸©åº¦100é‡é‡25", "æ¸©åº¦100é‡é‡25", "âœ… æ··åˆæ–‡æœ¬ï¼Œåªæå–é100å€æ•°", [25.0]),
        ("ç”¨æˆ·è¯´ï¼šåˆ‡æ¢åˆ°200", "åˆ‡æ¢åˆ°200", "âŒ è¯­éŸ³å‘½ä»¤ï¼Œè·³è¿‡", []),
        ("ç”¨æˆ·è¯´ï¼šè®¾ç½®åºå·300", "è®¾ç½®åºå·300", "âŒ è¯­éŸ³å‘½ä»¤ï¼Œè·³è¿‡", []),

        # ===== ä¸­æ–‡æ•°å­—æ¼”ç¤º =====
        ("ç”¨æˆ·è¯´ï¼šäºŒç™¾", "200", "âœ… ä¸­æ–‡æ•°å­—è½¬æ¢ï¼Œæå–", [200.0]),
        ("ç”¨æˆ·è¯´ï¼šä¸€åƒä¸‰ç™¾", "1300", "âœ… ä¸­æ–‡æ•°å­—è½¬æ¢ï¼Œæå–", [1300.0]),
        ("ç”¨æˆ·è¯´ï¼šé•¿åº¦äºŒç™¾", "é•¿åº¦200", "âŒ æ–‡æœ¬ä¸­çš„ä¸­æ–‡æ•°å­—ï¼Œè·³è¿‡", []),

        # ===== è¾¹ç•Œæƒ…å†µæ¼”ç¤º =====
        ("ç”¨æˆ·è¯´ï¼šäº§å“Aä»·æ ¼200æ•°é‡50", "äº§å“Aä»·æ ¼200æ•°é‡50", "âœ… å¤æ‚æ–‡æœ¬ï¼Œæå–é100å€æ•°", [50.0]),
        ("è®¢å•å·100æ€»é‡‘é¢500", "è®¢å•å·100æ€»é‡‘é¢500", "âŒ 500è¢«è·³è¿‡ï¼ˆæ€»é‡‘é¢å‰æœ‰å­—ç¬¦ï¼‰", []),
        ("", "", "âœ… ç©ºæ–‡æœ¬ï¼Œè¿”å›ç©ºåˆ—è¡¨", []),
        ("æ— æ•°å­—æ–‡æœ¬", "æ— æ•°å­—æ–‡æœ¬", "âœ… æ— æ•°å­—ï¼Œè¿”å›ç©ºåˆ—è¡¨", []),
    ]

    passed = 0
    failed = 0

    for i, (original, processed, description, expected) in enumerate(demo_cases, 1):
        print(f"\nğŸ“ æ¼”ç¤º {i:2d}: {description}")
        print(f"   åŸå§‹: '{original}' -> å¤„ç†: '{processed}'")

        result = processor.extract_numbers(original, processed, command_processor)

        if result == expected:
            print(f"   âœ… ç»“æœ: {result}")
            passed += 1
        else:
            print(f"   âŒ ç»“æœ: {result} (æœŸæœ›: {expected})")
            failed += 1

    # æ€»ç»“
    print("\n" + "=" * 80)
    print(f"ğŸ“Š æ¼”ç¤ºç»“æœ: {passed}/{len(demo_cases)} é€šè¿‡")
    print()
    print("âœ¨ æ ¸å¿ƒåŠŸèƒ½éªŒè¯:")
    print("   âœ… æ­£ç¡®æå–çº¯æ•°å­—ï¼ˆ200, 1300ï¼‰")
    print("   âœ… æ­£ç¡®è·³è¿‡æ–‡æœ¬ä¸­çš„100å€æ•°ï¼ˆåƒé¥­200, ä»·æ ¼ä¸º300å…ƒï¼‰")
    print("   âœ… æ­£ç¡®æå–é100å€æ•°ï¼ˆ50, 25.5ï¼‰")
    print("   âœ… æ­£ç¡®å¤„ç†æ··åˆæ–‡æœ¬ï¼ˆåªæå–é100å€æ•°ï¼‰")
    print("   âœ… æ­£ç¡®éªŒè¯è¯­éŸ³å‘½ä»¤ï¼ˆè·³è¿‡å‘½ä»¤ä¸­çš„æ•°å­—ï¼‰")
    print("   âœ… æ­£ç¡®å¤„ç†ä¸­æ–‡æ•°å­—è½¬æ¢")
    print("   âœ… æ­£ç¡®å¤„ç†è¾¹ç•Œæƒ…å†µ")
    print()
    print("ğŸ¯ ä¸¥æ ¼éªŒè¯è§„åˆ™æˆåŠŸå®ç°ç”¨æˆ·éœ€æ±‚ï¼")
    print("   - é˜²æ­¢ä»æ–‡æœ¬ä¸Šä¸‹æ–‡ï¼ˆå¦‚'åƒé¥­200'ï¼‰ä¸­æå–100å€æ•°")
    print("   - ç¡®ä¿çº¯æ•°å­—è¾“å…¥ï¼ˆå¦‚'200'ï¼‰ä»èƒ½è¢«æ­£ç¡®æå–")
    print("   - ä¿æŒé100å€æ•°ï¼ˆå¦‚'50'ï¼‰çš„æ­£å¸¸æå–")
    print("   - é›†æˆè¯­éŸ³å‘½ä»¤éªŒè¯æœºåˆ¶")

    return failed == 0


if __name__ == "__main__":
    demo_strict_validation()
