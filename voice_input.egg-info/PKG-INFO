Metadata-Version: 2.4
Name: voice-input
Version: 0.1.2
Summary: A powerful real-time voice recognition offline system with pause/resume functionality and automatic Excel export capabilities.
Author-email: "Pierre.W" <xingw1013@gmail.com>
Requires-Python: >=3.11
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: certifi==2025.8.3
Requires-Dist: cffi==2.0.0
Requires-Dist: charset-normalizer==3.4.3
Requires-Dist: cn2an==0.5.23
Requires-Dist: colorama==0.4.6
Requires-Dist: et-xmlfile==2.0.0
Requires-Dist: funasr>=1.2.7
Requires-Dist: idna==3.10
Requires-Dist: ipykernel>=6.30.1
Requires-Dist: mypy==1.18.2
Requires-Dist: mypy-extensions==1.1.0
Requires-Dist: numpy<2
Requires-Dist: onnxruntime==1.15.1
Requires-Dist: openpyxl==3.1.5
Requires-Dist: pandas==2.3.2
Requires-Dist: pandas-stubs==2.3.2.250926
Requires-Dist: pathspec==0.12.1
Requires-Dist: piper-tts>=1.3.0
Requires-Dist: pre-commit>=4.3.0
Requires-Dist: proces==0.1.7
Requires-Dist: pyaudio==0.2.14
Requires-Dist: pycparser==2.23
Requires-Dist: pynput==1.8.1
Requires-Dist: pytest>=8.4.2
Requires-Dist: pytest-cov>=7.0.0
Requires-Dist: python-dateutil==2.9.0.post0
Requires-Dist: pytz==2025.2
Requires-Dist: requests==2.32.5
Requires-Dist: six==1.17.0
Requires-Dist: sounddevice>=0.5.2
Requires-Dist: speechrecognition==3.14.3
Requires-Dist: srt==3.5.3
Requires-Dist: torch>=2.9.0
Requires-Dist: torchaudio>=2.9.0
Requires-Dist: tqdm==4.67.1
Requires-Dist: tree>=0.2.4
Requires-Dist: types-openpyxl==3.1.5.20250919
Requires-Dist: types-pyaudio==0.2.16.20250801
Requires-Dist: types-pynput==1.8.1.20250809
Requires-Dist: types-pytz==2025.2.0.20250809
Requires-Dist: typing-extensions==4.15.0
Requires-Dist: tzdata==2025.2
Requires-Dist: urllib3==2.5.0
Requires-Dist: vosk==0.3.45
Requires-Dist: websockets==15.0.1
Dynamic: license-file

# ğŸ¤ Voice Input System

ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ç¦»çº¿å®æ—¶è¯­éŸ³è¯†åˆ«ç³»ç»Ÿï¼Œå…·æœ‰æš‚åœ/æ¢å¤åŠŸèƒ½ã€è‡ªåŠ¨Excelå¯¼å‡ºèƒ½åŠ›å’Œæ–‡æœ¬è½¬è¯­éŸ³(TTS)åé¦ˆã€‚
A powerful offline real-time voice recognition system with pause/resume capabilities, automatic Excel export, and text-to-speech (TTS) feedback.

## ğŸ“š é¡¹ç›®ç®€ä»‹
è¿™æ˜¯ä¸€ä¸ªä¸“ä¸ºä¸­æ–‡è¯­éŸ³è¯†åˆ«è®¾è®¡çš„ç³»ç»Ÿï¼Œå¯ç¦»çº¿éƒ¨ç½²ç”¨äºå®æ—¶è®°å½•æµ‹é‡æ•°æ®å¹¶è‡ªåŠ¨å¯¼å‡ºåˆ°Excelè¡¨æ ¼ä¸­ã€‚ç³»ç»Ÿæ”¯æŒè¯­éŸ³å‘½ä»¤æ§åˆ¶ã€é”®ç›˜å¿«æ·æ“ä½œã€ä¸­æ–‡æ•°å­—è‡ªåŠ¨è½¬æ¢å’Œè¯­éŸ³åé¦ˆåŠŸèƒ½ã€‚
## ğŸ“š Project Introduction
This is a system designed specifically for Chinese voice recognition, which can be used to record measurement data in real-time and automatically export it to Excel spreadsheets. The system supports voice command control, keyboard shortcuts, automatic Chinese number conversion, and voice feedback functionality.

## ğŸŒŸ ç‰¹æ€§
## ğŸŒŸ Features

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½
- **å®æ—¶è¯­éŸ³è¯†åˆ«**ï¼šä½¿ç”¨Voskè¿›è¡Œè¿ç»­è¯­éŸ³è½¬æ–‡æœ¬è½¬æ¢
- **æš‚åœ/æ¢å¤æ§åˆ¶**ï¼šé€šè¿‡ç©ºæ ¼é”®å’Œè¯­éŸ³å‘½ä»¤è¿›è¡Œæ™ºèƒ½çŠ¶æ€ç®¡ç†
- **è‡ªåŠ¨Excelå¯¼å‡º**ï¼šåœ¨æš‚åœ/åœæ­¢æ—¶è‡ªåŠ¨å°†æ•°æ®ä¿å­˜åˆ°Excel
- **ä¸­æ–‡æ•°å­—è¯†åˆ«**ï¼šæ”¯æŒå°†ä¸­æ–‡æ•°å­—è½¬æ¢ä¸ºé˜¿æ‹‰ä¼¯æ•°å­—
- **ä¸“ä¸šExcelæ ¼å¼åŒ–**ï¼šè‡ªåŠ¨ç¼–å·ã€æ—¶é—´æˆ³ã€å¸¦é€‚å½“æ ¼å¼çš„æ ‡é¢˜
- **æ–‡æœ¬è½¬è¯­éŸ³åé¦ˆ**ï¼šè¯†åˆ«åˆ°çš„æ•°å­—æä¾›è¯­éŸ³ç¡®è®¤ï¼ˆé€šè¿‡'t'é”®åˆ‡æ¢ï¼‰
### ğŸ¯ Core Features
- **Real-time Voice Recognition**: Continuous speech-to-text conversion using Vosk
- **Pause/Resume Control**: Smart state management with space bar and voice commands
- **Automatic Excel Export**: Data automatically saved to Excel on pause/stop
- **Chinese Number Recognition**: Supports conversion of Chinese numerals to Arabic numerals
- **Professional Excel Formatting**: Auto-numbering, timestamps, headers with proper formatting
- **Text-to-Speech Feedback**: Audio confirmation of recognized numbers (toggle with 't' key)

### ğŸ® æ§åˆ¶æ–¹æ³•
#### é”®ç›˜æ§åˆ¶
- **ç©ºæ ¼é”®**ï¼šå¼€å§‹/æš‚åœ/æ¢å¤ï¼ˆå¾ªç¯æ§åˆ¶ï¼‰
- **ESCé”®**ï¼šåœæ­¢å¹¶é€€å‡º
- **'t'é”®**ï¼šåˆ‡æ¢æ–‡æœ¬è½¬è¯­éŸ³(TTS)å¼€å…³

#### è¯­éŸ³å‘½ä»¤
- **"æš‚åœå½•éŸ³" / "æš‚åœ"**ï¼šæš‚åœå½•éŸ³
- **"ç»§ç»­å½•éŸ³" / "ç»§ç»­" / "æ¢å¤"**ï¼šæ¢å¤å½•éŸ³
- **"åœæ­¢å½•éŸ³" / "åœæ­¢" / "ç»“æŸ"**ï¼šåœæ­¢ç³»ç»Ÿ
### ğŸ® Control Methods
#### Keyboard Controls
- **Space Bar**: Start/Pause/Resume (cycle control)
- **ESC Key**: Stop and exit
- **'t' Key**: Toggle Text-to-Speech (TTS) on/off

#### Voice Commands
- **"æš‚åœå½•éŸ³" / "æš‚åœ"**: Pause recording
- **"ç»§ç»­å½•éŸ³" / "ç»§ç»­" / "æ¢å¤"**: Resume recording
- **"åœæ­¢å½•éŸ³" / "åœæ­¢" / "ç»“æŸ"**: Stop system

### ğŸ”§ æŠ€æœ¯ç‰¹æ€§
- **ç»Ÿä¸€çŠ¶æ€ç®¡ç†**ï¼šæ¸…æ™°çš„çŠ¶æ€æœºï¼ˆç©ºé—²/å½•éŸ³/æš‚åœ/åœæ­¢ï¼‰
- **è¯­éŸ³é”™è¯¯çº æ­£**ï¼šå¯è‡ªå®šä¹‰è¯å…¸ç”¨äºè‡ªåŠ¨ä¿®å¤è¯†åˆ«é”™è¯¯
- **çº¿ç¨‹å®‰å…¨**ï¼šæ­£ç¡®çš„å¹¶å‘æ“ä½œå¤„ç†
- **å†…å­˜ç®¡ç†**ï¼šè‡ªåŠ¨èµ„æºæ¸…ç†å’Œåƒåœ¾å›æ”¶
- **å…¨é¢æ—¥å¿—è®°å½•**ï¼šå¸¦æœ‰æ–‡ä»¶å’Œæ§åˆ¶å°è¾“å‡ºçš„è¯¦ç»†æ“ä½œæ—¥å¿—
### ğŸ”§ Technical Features
- **Unified State Management**: Clean state machine (idle/recording/paused/stopped)
- **Voice Error Correction**: Customizable dictionary for fixing recognition errors automatically
- **Thread Safety**: Proper concurrent operation handling
- **Memory Management**: Automatic resource cleanup and garbage collection
- **Comprehensive Logging**: Detailed operation logs with file and console output

## âš ï¸ å½“å‰é™åˆ¶
- **ç‰¹æ®Šæ•°å­—åºåˆ—**ï¼š"ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹å"ç°åœ¨æ”¯æŒé€å­—ç¬¦è½¬æ¢ï¼ˆ12345678910ï¼‰
- **è´Ÿæ•°**ï¼šç°åœ¨é€šè¿‡æ£€æµ‹è´Ÿæ•°å­—ç¬¦ä¸²å¹¶åœ¨æ£€æµ‹åˆ°è´Ÿæ•°æ—¶è¿”å›ç©ºåˆ—è¡¨æ¥æ­£ç¡®å¤„ç†
## âš ï¸ Current Limitations
- **Special Number Sequences**: "ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹å" now supports character-by-character conversion (12345678910)
- **Negative Numbers**: Now properly handled by detecting negative keywords and returning empty list when detected

## ğŸš€ å¿«é€Ÿå¼€å§‹
## ğŸš€ Quick Start

### å…ˆå†³æ¡ä»¶
```bash
# ç¡®ä¿è™šæ‹Ÿç¯å¢ƒå·²æ¿€æ´»
source .venv/scripts/activate  # Windows Git Bash
# æˆ–
.venv\Scripts\activate  # Windowså‘½ä»¤æç¤ºç¬¦
```
### Prerequisites
```bash
# Ensure virtual environment is activated
source .venv/scripts/activate  # Windows Git Bash
# or
.venv\Scripts\activate  # Windows Command Prompt
```

### åŸºæœ¬ä½¿ç”¨
```bash
# å¯åŠ¨ç³»ç»Ÿ
python main.py
```
### Basic Usage
```bash
# Start the system
python main.py
```

### æµ‹è¯•
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
python -m pytest -v

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
python -m pytest test_main_integration.py -v
```
### Testing
```bash
# Run all tests
python -m pytest -v

# Run specific test file
python -m pytest test_main_integration.py -v
```

## ğŸ“ é¡¹ç›®ç»“æ„
## ğŸ“ Project Structure

```
Voice_Input/
â”œâ”€â”€ main.py                       # ä¸»å…¥å£ç‚¹ / Main entry point
â”œâ”€â”€ audio_capture_v.py            # éŸ³é¢‘æ•è·å’Œè¯†åˆ« / Audio capture and recognition
â”œâ”€â”€ excel_exporter.py             # Excelå¯¼å‡ºåŠŸèƒ½ / Excel export functionality
â”œâ”€â”€ TTSengine.py                  # æ–‡æœ¬è½¬è¯­éŸ³å¼•æ“ / Text-to-Speech engine
â”œâ”€â”€ model_manager.py              # æ¨¡å‹åŠ è½½å’Œç®¡ç† / Model loading and management
â”œâ”€â”€ config_loader.py              # é…ç½®åŠ è½½ / Configuration loading
â”œâ”€â”€ claude/                       # æ–‡æ¡£æ–‡ä»¶å¤¹ / Documentation folder
â”‚   â”œâ”€â”€ PROJECT_SUMMARY.md        # å®Œæ•´é¡¹ç›®æ¦‚è¿° / Complete project overview
â”‚   â”œâ”€â”€ QUICK_REFERENCE.md        # å¿«é€Ÿå‘½ä»¤å‚è€ƒ / Quick commands reference
â”‚   â”œâ”€â”€ TEST_RESULTS.md           # æµ‹è¯•ç»“æœå’ŒçŠ¶æ€ / Test results and status
â”‚   â”œâ”€â”€ CHANGELOG.md              # ç‰ˆæœ¬å†å² / Version history
â”‚   â””â”€â”€ README.md                 # æ–‡æ¡£å¯¼èˆª / Documentation navigation
â”œâ”€â”€ test_*.py                     # æµ‹è¯•æ–‡ä»¶ï¼ˆ10+æµ‹è¯•æ–‡ä»¶ï¼‰ / Test files (10+ test files)
â”œâ”€â”€ tests/                        # é›†æˆæµ‹è¯•ç›®å½• / Integration tests directory
â”œâ”€â”€ voice_correction_dict.txt     # è¯­éŸ³é”™è¯¯çº æ­£ / Voice error corrections
â”œâ”€â”€ pyproject.toml                # é¡¹ç›®é…ç½® / Project configuration
â”œâ”€â”€ requirements.txt              # Pythonä¾èµ–é¡¹ / Python dependencies
â””â”€â”€ voice_input.log               # è¿è¡Œæ—¶æ—¥å¿— / Runtime logs
```

## âš™ï¸ é…ç½®
## âš™ï¸ Configuration

### æ¨¡å‹é€‰æ‹©
```python
# åœ¨AudioCaptureæ„é€ å‡½æ•°ä¸­é…ç½®
model_path="model/cn"   # ä¸­æ–‡æ ‡å‡†ï¼ˆé«˜ç²¾åº¦ï¼‰
model_path="model/cns"  # ä¸­æ–‡å°æ¨¡å‹ï¼ˆå¿«é€ŸåŠ è½½ï¼‰
model_path="model/us"   # è‹±æ–‡æ ‡å‡†
model_path="model/uss"  # è‹±æ–‡å°æ¨¡å‹
```
### Model Selection
```python
# Configure in AudioCapture constructor
model_path="model/cn"   # Chinese standard (high accuracy)
model_path="model/cns"  # Chinese small (fast loading)
model_path="model/us"   # English standard
model_path="model/uss"  # English small
```

### è¶…æ—¶é…ç½®
```python
# è®¾ç½®è¯­éŸ³è¯†åˆ«è¶…æ—¶æ—¶é—´
system = VoiceInputSystem(timeout_seconds=xx) xxç§’èŒƒå›´åœ¨[1, 60]
```
### Timeout Configuration
```python
# Set timeout for voice recognition
system = VoiceInputSystem(timeout_seconds=xx) xx seconds in the range [1, 60]
```

### æ¨¡å‹å…¨å±€æ“ä½œ
### Model Global Operations

#### å…¨å±€é¢„åŠ è½½æ¨¡å‹
å…¨å±€é¢„åŠ è½½æ¨¡å‹å¯ä»¥æ˜¾è‘—æé«˜è¿è¡Œå¤šä¸ªæµ‹è¯•æˆ–å®ä¾‹æ—¶çš„æ€§èƒ½ã€‚
```bash
# é¢„åŠ è½½é»˜è®¤æ¨¡å‹ï¼ˆmodel/cnï¼‰
python preload_model.py

# é¢„åŠ è½½ç‰¹å®šæ¨¡å‹
python preload_model.py --model_path model/cns
# æˆ–é€šè¿‡ç¯å¢ƒå˜é‡
MODEL_PATH=model/cns python preload_model.py
```
#### Preload Model Globally
Preloading the model globally can significantly improve performance when running multiple tests or instances.
```bash
# Preload default model (model/cn)
python preload_model.py

# Preload specific model
python preload_model.py --model_path model/cns
# or via environment variable
MODEL_PATH=model/cns python preload_model.py
```

#### å…¨å±€å¸è½½æ¨¡å‹
å½“ä¸å†éœ€è¦æ¨¡å‹æ—¶ï¼Œå¸è½½æ¨¡å‹ä»¥é‡Šæ”¾å†…å­˜ã€‚
```bash
# å¸è½½ç‰¹å®šæ¨¡å‹
python unload_model_global.py --model_path model/cn
# å¸è½½æ‰€æœ‰æ¨¡å‹
python unload_model_global.py --all
```
#### Unload Model Globally
Unload models to free up memory when they are no longer needed.
```bash
# Unload specific model
python unload_model_global.py --model_path model/cn
# Unload all models
python unload_model_global.py --all
```

#### ä¸»ç³»ç»Ÿå…¨å±€å¸è½½æ§åˆ¶
ä¸»ç³»ç»Ÿå¯ä»¥é…ç½®ä¸ºæ§åˆ¶å…¨å±€å¸è½½è¡Œä¸ºï¼š
```bash
# å¯ç”¨é€€å‡ºæ—¶å…¨å±€å¸è½½
python main.py --global-unload
# æˆ–é€šè¿‡ç¯å¢ƒå˜é‡
VOICE_INPUT_GLOBAL_UNLOAD=1 python main.py
```
#### Main System Global Unload Control
The main system can be configured to control global unloading behavior:
```bash
# Enable global unloading on exit
python main.py --global-unload
# or via environment variable
VOICE_INPUT_GLOBAL_UNLOAD=1 python main.py
```

## ğŸ§ª æµ‹è¯•
## ğŸ§ª Testing

### æµ‹è¯•ç»“æœ
- **æ€»æµ‹è¯•æ•°**ï¼š18+
- **é€šè¿‡æ•°**ï¼š18+
- **æˆåŠŸç‡**ï¼š100%
- **è¦†ç›–èŒƒå›´**ï¼šå…¨é¢çš„æ ¸å¿ƒåŠŸèƒ½ï¼ŒåŒ…æ‹¬æ•°å­—è¯†åˆ«ã€çŠ¶æ€ç®¡ç†å’ŒTTSé›†æˆ
### Test Results
- **Total Tests**: 18+
- **Passing**: 18+
- **Success Rate**: 100%
- **Coverage**: Comprehensive core functionality including number recognition, state management, and TTS integration

### è¿è¡Œæµ‹è¯•
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
python -m pytest -v

# è¿è¡Œé›†æˆæµ‹è¯•
python -m pytest test_main_integration.py -v

# è¿è¡Œå®Œæ•´ç³»ç»Ÿæµ‹è¯•
python -m pytest test_main_full_system.py -v
```
### Run Tests
```bash
# Run all tests
python -m pytest -v

# Run integration tests
python -m pytest test_main_integration.py -v

# Run full system tests
python -m pytest test_main_full_system.py -v
```

### æµ‹è¯•æ–‡ä»¶
### Test Files
- `tests/integrated_test.py` - æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•
- `test_comprehensive_recognition.py` - ç»¼åˆè¯­éŸ³è¯†åˆ«æµ‹è¯•
- `test_five_recognition.py` - ç‰¹å®šæ•°å­—è¯†åˆ«æµ‹è¯•
- `test_keyboard_response.py` - é”®ç›˜æ§åˆ¶æµ‹è¯•
- `test_model_manager.py` - æ¨¡å‹ç®¡ç†æµ‹è¯•
- `test_performance_recognition.py` - æ€§èƒ½æµ‹è¯•
- `test_recognition_fix.py` - è¯†åˆ«ä¿®å¤å’Œçº æ­£
- `test_cn2an.py` - ä¸­æ–‡æ•°å­—è½¬æ¢æµ‹è¯•


## ğŸ“Š ä½¿ç”¨ç¤ºä¾‹
## ğŸ“Š Usage Examples

### åŸºæœ¬è¯­éŸ³è¾“å…¥
```
ç”¨æˆ·è¯´ï¼š"æ¸©åº¦äºŒåäº”ç‚¹äº”åº¦"
ç³»ç»Ÿè¯†åˆ«ï¼štemperature 25.5 degrees
Excelè¾“å‡ºï¼š| ç¼–å· | æµ‹é‡å€¼ | æ—¶é—´æˆ³ |
         |   1  |  25.5  | 2024-... |
```
### Basic Voice Input
```
User says: "æ¸©åº¦äºŒåäº”ç‚¹äº”åº¦"
System recognizes: temperature 25.5 degrees
Excel output:| ID | Value | Timestamp |
          |  1   |  25.5  | 2024-... |
```

### è¯­éŸ³å‘½ä»¤
```
ç”¨æˆ·è¯´ï¼š"æš‚åœå½•éŸ³"
ç³»ç»Ÿå“åº”ï¼šâ¸ï¸ æš‚åœè¯†åˆ«
         ğŸ“ å°†Xæ¡è®°å½•å†™å…¥Excel...
         âœ… Excelå†™å…¥æˆåŠŸ
```
### Voice Commands
```
User says: "æš‚åœå½•éŸ³"
System response: â¸ï¸ Paused recognition
         ğŸ“ Writing X records to Excel...
         âœ… Excel write successful
```

### Excelè¾“å‡ºæ ¼å¼
- **æ–‡ä»¶**ï¼š`measurement_data.xlsx`
- **åˆ—**ï¼šç¼–å· (ID) | æµ‹é‡å€¼ (Value) | æ—¶é—´æˆ³ (Timestamp)
- **ç‰¹æ€§**ï¼šè‡ªåŠ¨ç¼–å·ã€ä¸“ä¸šæ ¼å¼åŒ–ã€è¿ç»­ID
### Excel Output Format
- **File**: `measurement_data.xlsx`
- **Columns**: ç¼–å· (ID) | æµ‹é‡å€¼ (Value) | æ—¶é—´æˆ³ (Timestamp)
- **Features**: Auto-numbering, professional formatting, continuous IDs

## ğŸ”§ é«˜çº§ç‰¹æ€§
## ğŸ”§ Advanced Features

### è¯­éŸ³é”™è¯¯çº æ­£
- **æ–‡ä»¶**ï¼š`voice_correction_dict.txt`
- **æ ¼å¼**ï¼š`wrong_word=correct_word`
- **ç›®çš„**ï¼šè‡ªåŠ¨ä¿®å¤å¸¸è§è¯†åˆ«é”™è¯¯
### Voice Error Correction
- **File**: `voice_correction_dict.txt`
- **Format**: `wrong_word=correct_word`
- **Purpose**: Fix common recognition errors automatically

### æ•°æ®ç¼“å†²
- **ç¼“å†²åŒº**ï¼šå¾ªç¯åŒç«¯é˜Ÿåˆ—ï¼ˆæœ€å¤š10,000æ¡è®°å½•ï¼‰
- **å¯¼å‡º**ï¼šæš‚åœ/åœæ­¢æ—¶è‡ªåŠ¨å¯¼å‡º
- **çº¿ç¨‹å®‰å…¨**ï¼šæ­£ç¡®çš„é”å®šæœºåˆ¶
### Data Buffering
- **Buffer**: Circular deque (10,000 records max)
- **Export**: Automatic on pause/stop
- **Thread Safety**: Proper locking mechanisms

### çŠ¶æ€ç®¡ç†
- **çŠ¶æ€**ï¼šidle â†’ recording â†’ paused â†’ stopped
- **è½¬æ¢**ï¼šç©ºæ ¼é”®å¾ªç¯ï¼Œè¯­éŸ³å‘½ä»¤ï¼ŒESCåœæ­¢
- **å®‰å…¨**ï¼šæ­£ç¡®çš„æ¸…ç†å’Œèµ„æºç®¡ç†
### State Management
- **States**: idle â†’ recording â†’ paused â†’ stopped
- **Transitions**: Space key cycles, voice commands, ESC stops
- **Safety**: Proper cleanup and resource management

### æ–‡æœ¬è½¬è¯­éŸ³(TTS)é›†æˆ
- **åˆ‡æ¢**ï¼šæŒ‰'t'é”®å¯ç”¨/ç¦ç”¨TTS
- **åé¦ˆ**ï¼šä¸ºè¯†åˆ«çš„æ•°å­—æä¾›éŸ³é¢‘åé¦ˆ
- **çŠ¶æ€**ï¼šå¯åœ¨è¿è¡Œæ—¶å¯ç”¨/ç¦ç”¨
### Text-to-Speech (TTS) Integration
- **Toggle**: Press 't' key to enable/disable TTS
- **Feedback**: Provides audio feedback for recognized numbers
- **Status**: Can be enabled/disabled during runtime

## ğŸš¨ é”™è¯¯å¤„ç†
## ğŸš¨ Error Handling

### æ¨¡å‹åŠ è½½é”™è¯¯
```
âŒ æ¨¡å‹åŠ è½½å¤±è´¥ï¼š[é”™è¯¯è¯¦æƒ…]
ğŸ’¡ è¯·æ£€æŸ¥ï¼š
   1. æ¨¡å‹è·¯å¾„æ­£ç¡®ï¼šmodel/cn
   2. æ¨¡å‹æ–‡ä»¶å­˜åœ¨ä¸”å®Œæ•´
   3. æ¨¡å‹æ–‡ä»¶ä¸å½“å‰VOSKç‰ˆæœ¬å…¼å®¹
```
### Model Loading Errors
```
âŒ Model loading failed: [error details]
ğŸ’¡ Please check:
   1. Model path is correct: model/cn
   2. Model files exist and are complete
   3. Model files are compatible with current VOSK version
```

### å¸¸è§é—®é¢˜
- **PyAudioæœªæ‰¾åˆ°**ï¼šåœ¨è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£…
- **Excelè¢«é”å®š**ï¼šåœ¨å†™å…¥å‰å…³é—­Excelæ–‡ä»¶
- **å†…å­˜é—®é¢˜**ï¼šæ£€æŸ¥ç¼“å†²åŒºå¤§å°å’Œæ¸…ç†
### Common Issues
- **PyAudio not found**: Install in virtual environment
- **Excel locked**: Close Excel file before writing
- **Memory issues**: Check buffer size and cleanup

## ğŸ“ˆ æ€§èƒ½
## ğŸ“ˆ Performance

- **å®æ—¶å¤„ç†**ï¼šä½å»¶è¿Ÿè¯­éŸ³è¯†åˆ«
- **å†…å­˜é«˜æ•ˆ**ï¼šå¾ªç¯ç¼“å†²åŒºé˜²æ­¢å†…å­˜æ³„æ¼
- **è‡ªåŠ¨æ¸…ç†**ï¼šè‡ªåŠ¨èµ„æºç®¡ç†
- **çº¿ç¨‹å®‰å…¨**ï¼šæ­£ç¡®çš„å¹¶å‘æ“ä½œå¤„ç†
- **Real-time Processing**: Low latency voice recognition
- **Memory Efficient**: Circular buffer prevents memory leaks
- **Auto-cleanup**: Automatic resource management
- **Thread Safety**: Proper concurrent operation handling

## ğŸ› ï¸ å¼€å‘ç¯å¢ƒ
## ğŸ› ï¸ Development Environment

### è™šæ‹Ÿç¯å¢ƒ
```bash
# Pythonç‰ˆæœ¬ï¼š3.11.11
# æ¿€æ´»ï¼šsource .venv/scripts/activate
# ä¾èµ–é¡¹ï¼šå‚è§pyproject.toml
```
### Virtual Environment
```bash
# Python version: 3.11.11
# Activation: source .venv/scripts/activate
# Dependencies: See pyproject.toml
```

### ä¸»è¦ä¾èµ–é¡¹
- **pyaudio**: 0.2.14 - éŸ³é¢‘æ•è·
- **vosk**: 0.3.45 - è¯­éŸ³è¯†åˆ«
- **pandas**: 2.3.2 - æ•°æ®æ“ä½œ
- **openpyxl**: 3.1.5 - Excelå¤„ç†
- **pynput**: 1.8.1 - é”®ç›˜ç›‘æ§
- **cn2an**: 0.5.23 - ä¸­æ–‡æ•°å­—è½¬æ¢
- **TTS**: é›†æˆæ–‡æœ¬è½¬è¯­éŸ³å¼•æ“
### Key Dependencies
- **pyaudio**: 0.2.14 - Audio capture
- **vosk**: 0.3.45 - Voice recognition
- **pandas**: 2.3.2 - Data manipulation
- **openpyxl**: 3.1.5 - Excel handling
- **pynput**: 1.8.1 - Keyboard monitoring
- **cn2an**: 0.5.23 - Chinese number conversion
- **TTS**: Integrated text-to-speech engine

## ğŸ“š æ–‡æ¡£
## ğŸ“š Documentation

### Claudeæ–‡æ¡£
å®Œæ•´æ–‡æ¡£åœ¨`claude/`æ–‡ä»¶å¤¹ä¸­å¯ç”¨ï¼š
- **é¡¹ç›®æ‘˜è¦**ï¼šå®Œæ•´åŠŸèƒ½æ¦‚è¿°
- **å¿«é€Ÿå‚è€ƒ**ï¼šå‘½ä»¤å’Œç”¨æ³•
- **æµ‹è¯•ç»“æœ**ï¼šå½“å‰æµ‹è¯•çŠ¶æ€
- **å˜æ›´æ—¥å¿—**ï¼šç‰ˆæœ¬å†å²
### Claude Documentation
Complete documentation available in `claude/` folder:
- **Project Summary**: Complete feature overview
- **Quick Reference**: Commands and usage
- **Test Results**: Current test status
- **Changelog**: Version history

## ğŸ¤ è´¡çŒ®
## ğŸ¤ Contributing

1. Forkä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. ä¸ºæ–°åŠŸèƒ½æ·»åŠ æµ‹è¯•
4. ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼š`python -m pytest -v`
5. æäº¤æ‹‰å–è¯·æ±‚
1. Fork the repository
2. Create feature branch
3. Add tests for new features
4. Ensure all tests pass: `python -m pytest -v`
5. Submit pull request

## ğŸ“„ è®¸å¯è¯
## ğŸ“„ License

è¯¥é¡¹ç›®æ ¹æ®MITè®¸å¯è¯æˆæƒ - è¯¦è§LICENSEæ–‡ä»¶ã€‚
This project is licensed under the MIT License - see the LICENSE file for details.

## ğŸ™ è‡´è°¢
## ğŸ™ Acknowledgments

- [Vosk](https://alphacephei.com/vosk/) ç”¨äºè¯­éŸ³è¯†åˆ«å¼•æ“
- [pandas](https://pandas.pydata.org/) ç”¨äºæ•°æ®æ“ä½œ
- [openpyxl](https://openpyxl.readthedocs.io/) ç”¨äºExcelå¤„ç†
- [pynput](https://pypi.org/project/pynput/) ç”¨äºé”®ç›˜ç›‘æ§
- [cn2an](https://pypi.org/project/cn2an/) ç”¨äºä¸­æ–‡æ•°å­—è½¬æ¢
- [Vosk](https://alphacephei.com/vosk/) for voice recognition engine
- [pandas](https://pandas.pydata.org/) for data manipulation
- [openpyxl](https://openpyxl.readthedocs.io/) for Excel handling
- [pynput](https://pypi.org/project/pynput/) for keyboard monitoring
- [cn2an](https://pypi.org/project/cn2an/) for Chinese number conversion

---

## ğŸ“ æ”¯æŒ
## ğŸ“ Support

å¯¹äºé—®é¢˜å’Œç–‘é—®ï¼š
1. æ£€æŸ¥`voice_input.log`è·å–é”™è¯¯è¯¦æƒ…
2. æŸ¥çœ‹`claude/`æ–‡ä»¶å¤¹ä¸­çš„æ–‡æ¡£
3. è¿è¡Œæµ‹è¯•ä»¥éªŒè¯åŠŸèƒ½
4. åœ¨GitHubä»“åº“ä¸­åˆ›å»ºé—®é¢˜
For issues and questions:
1. Check `voice_input.log` for error details
2. Review documentation in `claude/` folder
3. Run tests to verify functionality
4. Create issue in GitHub repository

**çŠ¶æ€**ï¼šâœ… ç”Ÿäº§å°±ç»ª | **æµ‹è¯•**ï¼š18+/18+ é€šè¿‡ | **ç‰ˆæœ¬**ï¼šv1.2.0
**Status**: âœ… Production Ready | **Tests**: 18+/18+ Passing | **Version**: v1.2.0

**Happy Voice Recognition!** ğŸ¤âœ¨
